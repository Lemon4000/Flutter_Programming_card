# Bug 修复测试指南

## 🧪 测试环境

### 已修复的功能
1. ✅ Linux 蓝牙连接
2. ✅ 连接后不再误报"已断开"

### 待测试的功能
3. ⚠️ Android 重连不黑屏
4. ⏳ 烧录停止功能（待实现）
5. ⏳ 参数持久化（待实现）

---

## 📝 测试步骤

### 测试 1: Linux 蓝牙连接 ✅

**目标**: 验证 Linux 桌面蓝牙连接功能正常

**步骤**:
1. 启动应用：
   ```bash
   cd ~/桌面/docs/plans/flutter
   flutter run -d linux
   ```

2. 在应用中：
   - 点击"扫描设备"
   - 选择一个蓝牙设备
   - 点击连接

**预期结果**:
- ✅ 扫描到蓝牙设备
- ✅ 连接成功
- ✅ 顶部显示"已连接到 [设备名]"
- ✅ 不显示"设备连接已断开"的错误提示

**实际结果**:
- 用户反馈：蓝牙功能好了 ✅

---

### 测试 2: 连接后不误报断开 ✅

**目标**: 验证连接成功后不会立即显示"已断开"

**步骤**:
1. 连接任意蓝牙设备
2. 观察屏幕底部的提示信息

**预期结果**:
- ✅ 只显示"已连接到 [设备名]"（绿色）
- ✅ 不显示"设备连接已断开"（红色）

**实际结果**: 待测试

---

### 测试 3: Android 重连不黑屏 ⚠️

**目标**: 验证 Android 设备断开后重连不会黑屏

**前提条件**:
- 需要 Android 设备
- 需要构建 APK

**步骤**:
1. 构建并安装 APK：
   ```bash
   flutter build apk --debug
   adb install build/app/outputs/flutter-apk/app-debug.apk
   ```

2. 在 Android 设备上：
   - 打开应用
   - 连接蓝牙设备
   - 断开蓝牙连接（关闭设备或走出范围）
   - 等待"设备连接已断开"提示
   - 重新连接设备

**预期结果**:
- ✅ 重连成功
- ✅ 界面正常显示
- ✅ 不出现黑屏

**实际结果**: 待测试

**如果仍然黑屏**:
- 检查日志：`adb logcat | grep flutter`
- 查找错误信息
- 可能需要额外的状态清理

---

### 测试 4: 烧录功能（当前状态）⏳

**目标**: 了解当前烧录功能的问题

**步骤**:
1. 连接设备
2. 选择固件文件
3. 点击"开始烧录"
4. 在烧录过程中尝试停止

**当前问题**:
- ❌ 烧录过程中没有"停止"按钮
- ❌ 无法中断烧录
- ❌ 重新烧录时状态未重置

**待实现**:
- 添加"停止烧录"按钮
- 实现停止逻辑
- 重置烧录状态

---

### 测试 5: 参数功能（当前状态）⏳

**目标**: 了解当前参数功能的问题

**步骤**:
1. 连接设备
2. 进入"参数"页面
3. 点击"读取参数"
4. 修改某些参数值
5. 退出参数页面
6. 重新进入参数页面

**当前问题**:
- ❌ 重新进入后显示默认值，不是之前读取的值
- ❌ 修改的参数没有视觉标识

**待实现**:
- 参数值持久化
- 修改的参数用颜色/图标标识
- 添加"恢复原始值"功能

---

## 🔧 快速测试命令

### Linux 桌面测试
```bash
# 启动应用
flutter run -d linux

# 查看日志（另一个终端）
flutter logs
```

### Android 设备测试
```bash
# 构建 APK
flutter build apk --debug

# 安装到设备
adb install build/app/outputs/flutter-apk/app-debug.apk

# 查看日志
adb logcat | grep flutter
```

### Windows 测试（如果需要）
```bash
flutter run -d windows
```

---

## 📊 测试结果记录

### 已通过的测试
- [x] Linux 蓝牙连接
- [ ] 连接后不误报断开
- [ ] Android 重连不黑屏

### 已知问题
- [ ] 烧录无法停止
- [ ] 参数不保存
- [ ] 参数修改无标识

---

## 🐛 问题报告模板

如果发现新问题，请记录：

**问题描述**:
[简短描述问题]

**复现步骤**:
1. [步骤1]
2. [步骤2]
3. [步骤3]

**预期行为**:
[应该发生什么]

**实际行为**:
[实际发生了什么]

**平台**:
- [ ] Linux
- [ ] Android
- [ ] Windows

**日志**:
```
[粘贴相关日志]
```

---

## 📞 获取帮助

如果遇到问题：
1. 查看 `BUG_FIXES_SUMMARY.md` 了解详细修复方案
2. 检查日志输出
3. 提供详细的错误信息

---

**创建时间**: 2026-01-23
**最后更新**: 2026-01-23
